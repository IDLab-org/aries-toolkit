{{- with .Values.agents.author }}
---
apiVersion: v1
kind: Secret
metadata:
  namespace: {{ $.Values.namespace }}
  name: {{ .name }}-env
type: Opaque
stringData:
  ACAPY_ENDORSER_ROLE: author
  # Multi-use invitation from endorser goes here
  ACAPY_ENDORSER_INVITATION: '{{ .invitation | toString }}'
  ACAPY_ENDORSER_PUBLIC_DID: {{ $.Values.agents.endorser.did }}
  ACAPY_ENDORSER_ALIAS: {{ $.Values.agents.endorser.alias }}
  # If not specified, the controller must invoke the request endorse operation for each transaction.
  ACAPY_AUTO_REQUEST_ENDORSEMENT: "true"
  # If not specified, the controller must invoke the write transaction operation for each transaction.
  ACAPY_AUTO_WRITE_TRANSACTIONS: "true"
  # If not specified, the controller must invoke the endpoints required to create the revocation registry and assign to the cred def.
  ACAPY_CREATE_REVOCATION_TRANSACTIONS: "true"
  ACAPY_AUTO_PROMOTE_AUTHOR_DID: "true"

  # Admin
  ACAPY_ADMIN_INSECURE_MODE: "true"
  # ACAPY_ADMIN_INSECURE_MODE: ""false""
  # ACAPY_ADMIN_API_KEY:  {{ .admin_api_key }}
  ACAPY_NO_RECEIVE_INVITES: "false"
  # ACAPY_HELP_LINK: Null
  ACAPY_WEBHOOK_URL: {{ $.Values.acapy_webhook_url }}
  # ACAPY_ADMIN_CLIENT_MAX_REQUEST_SIZE: 1 # Default

  # Discovery
  ACAPY_AUTO_DISCLOSE_FEATURES: "true"

  # Debug
  ACAPY_DEBUG_CONNECTIONS: "true"
  ACAPY_DEBUG_CREDENTIALS: "true"
  ACAPY_DEBUG_PRESENTATIONS: "true"
  ACAPY_DEBUG_WEBHOOKS: "true"

  # Initial Invite
  ACAPY_INVITE: "true"
  ACAPY_INVITE_LABEL: {{ .label }}
  ACAPY_INVITE_MULTI_USE: "true"
  ACAPY_INVITE_PUBLIC: "true"

  ACAPY_AUTO_ACCEPT_INVITES: "true"
  ACAPY_AUTO_ACCEPT_REQUESTS: "true"
  ACAPY_AUTO_RESPOND_MESSAGES: "true"
  ACAPY_AUTO_RESPOND_CREDENTIAL_PROPOSAL: "false"
  ACAPY_AUTO_RESPOND_CREDENTIAL_OFFER: "false"
  ACAPY_AUTO_RESPOND_CREDENTIAL_REQUEST: "false"
  ACAPY_AUTO_RESPOND_PRESENTATION_PROPOSAL: "false"
  ACAPY_AUTO_RESPOND_PRESENTATION_REQUEST: "false"
  ACAPY_AUTO_STORE_CREDENTIAL: "false"
  ACAPY_AUTO_VERIFY_PRESENTATION: "false"

  # Protocol
  ACAPY_AUTO_PING_CONNECTION: "true"
  ACAPY_AUTO_ACCEPT_INTRO_INVITATION_REQUESTS: "true"
  ACAPY_INVITE_BASE_URL: {{ .invite_base_url }}
  ACAPY_MONITOR_PING: "true" # Sends webhook
  ACAPY_MONITOR_FORWARD: "true" # Sends webhook
  ACAPY_PUBLIC_INVITES: "true"
  ACAPY_REQUESTS_THROUGH_PUBLIC_DID: "true" # Allow unsolicited connection requests
  ACAPY_TIMING: "true" # Include info in response
  ACAPY_PRESERVE_EXCHANGE_RECORDS: "true"
  ACAPY_EMIT_NEW_DIDCOMM_PREFIX: "true" # 'https://didcomm.org/' instead of (default) prefix 'did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/'
  ACAPY_EMIT_NEW_DIDCOMM_MIME_TYPE: "true" # RFC 0044 'application/didcomm-envelope-enc' instead of 'application/ssi-agent-wire' 
  ACAPY_EXCH_USE_UNENCRYPTED_TAGS: "false"

  # General
  ACAPY_STORAGE_TYPE: askar
  ACAPY_ENDPOINT: "https://{{ .endpoint }}.{{ $.Values.domain }}"
  # ACAPY_PROFILE_ENDPOINT: Null
  ACAPY_READ_ONLY_LEDGER: "false"
  ACAPY_AUTO_PROVISION: "true"
  ACAPY_LABEL: {{ .label }}
  ACAPY_IMAGE_URL: {{ .image_url }}
  ACAPY_ENABLE_UNDELIVERED_QUEUE: "true"
  # ACAPY_MAX_OUTBOUND_RETRY: Null # Default 4

  # Ledger
  # ACAPY_NO_LEDGER: "true"
  ACAPY_GENESIS_URL: {{ $.Values.genesis_url }}
  # ACAPY_LEDGER_KEEP_ALIVE: 5 # Default
  # ACAPY_ACCEPT_TAA: "false" # If not provided, the TAA must be accepted through the TTY or the admin API.

  # Wallet
  ACAPY_REPLACE_PUBLIC_DID: "true"
  ACAPY_RECREATE_WALLET: "false"
  ACAPY_WALLET_LOCAL_DID: "false"
  ACAPY_WALLET_ALLOW_INSECURE_SEED: "true"
  ACAPY_WALLET_TYPE: askar
  ACAPY_WALLET_NAME: {{ .wallet.name }}
  ACAPY_WALLET_KEY: {{ .wallet.key }}
  ACAPY_WALLET_SEED: {{ .wallet.seed }}
  # ACAPY_WALLET_STORAGE_TYPE: "postgres_storage"
  # ACAPY_WALLET_STORAGE_CREDS: '{"account":"{{ .wallet.user }}","password": "{{ .wallet.password }}","admin_account":"{{ .wallet.user }}", "admin_password":"{{ .wallet.password }}"}'
  # ACAPY_WALLET_STORAGE_CONFIG: '{"url":"{{ .name }}-wallet:{{ $.Values.postgres_port }}", "max_connections":5, "wallet_scheme":"MultiWalletSingleTable"}'
{{- end }}